<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>reveal.js</title>

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/custom.css" id="theme">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

        <script type="text/javascript" src="node_modules/jquery/dist/jquery.js"></script>

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
                <section>
                    <h2>Parallelization of Constraint Programming using Embarrassingly Parallel Search</h2>
                    Guillaume Derval<br/>
                    June 24th 2016
                </section>
                <!--<section>
                    <h3>Cloud is everywhere</h3>
                    <script type="text/javascript" src="//www.google.com/trends/embed.js?hl=en&q=/m/02y_9m3,+/m/0jgqg&cmpt=q&tz=Etc/GMT-2&tz=Etc/GMT-2&content=1&cid=TIMESERIES_GRAPH_0&export=5&w=500&h=330"></script>
                </section>
                <section>
                    <h3>Virtually unlimited distributed power</h3>
                    Amazon Web Services (in 2014): 2 000 000 servers<br/>
                    Usage increase: 132% YoY<br/>
                    <br/>
                    Microsoft (in 2015): 1 000 000 servers<br/>
                    <br/>
                    Google : something in between
                </section>-->
                <section>
                    <h3>Contents</h3>
                    <ul>
                        <li>CP, Parallel and Distributed Computing in 120 seconds</li>
                        <li>Distributing CP</li>
                        <li>Decompositions</li>
                        <li>Bound communication</li>
                        <li>OscaR-Modeling</li>
                        <li>Performances</li>
                    </ul>
                </section>
                <section data-background-image="img/backgrounds/green1.svg">
                    <h2>CP, Parallel and Distributed Computing in 120 seconds</h2>
                </section>
                <!--<section>
                    <h3>Constraint programming</h3>
                    To cite Eugene Freuder (in its famous paper In Pursuit of the Holy Grail):
                    <blockquote>
                        &ldquo;Constraint Programming represents one of the closest approaches computer science has yet
                        made to the Holy Grail of programming: the user states the problem, the computer solves it.&rdquo;
                    </blockquote>
                </section>-->
                <section>
                    <h3>Constraint programming<!--(2)--></h3>
                    <ul>
                        <li>Given a CSP/COP</li>
                        <li>Visit the "whole" search space</li>
                        <li>Cut in the tree using "constraints"</li>
                    </ul>
                </section>
                <section>
                    <h3>Serial, Parallel, Distributed computing</h3>
                    <img src="img/spd.svg" style="border:none; box-shadow: none; background: transparent"/>
                </section>
                <section>
                    <h3>Speedup<!-- and efficiency--></h3>
                    <h4>Speedup $S$ (in latency):</h4>
                    Ratio between the time taken to run on the "old" arch., and the time on the "new" one.
                    <!--<br/>
                    <br/>
                    <h4>Efficiency $\eta$:</h4>
                    Speedup divided by the number of threads/cores/workers involved.-->
                </section>
				<section data-background-image="img/backgrounds/lightred1.svg">
                    <h1>Distributing CP</h1>
                </section>
                <section>
                    <h3>Static Decomposition</h3>
                    <ul>
                        <li class="fragment">Divide the initial problem</li>
                        <li class="fragment">S.t. each worker has a subproblem</li>
                        <li class="fragment">Decomposing is hard</li>
                    </ul>
                    <iframe data-src="static-decomposition.html" width="540px" height="400px" style="margin: auto;"></iframe>
                </section>
                <section  data-background-image="img/backgrounds/lightgrey2.svg">
                    <h3>Work-Stealing</h3>
                    Idle workers "steals" work<br/>
                    <br/>
                    <!--<ul>
                        <li>Idle workers "steals" work</li>
                        <li class="fragment">Start with a single worker with the full problem</li>
                        <li class="fragment"><i>Idle</i> worker stop <i>solving</i> workers to ask for work</li>
                        <li class="fragment">Difficult to say when to stop</li>
                        <li class="fragment">Too much communication -> slow</li>
                    </ul>-->
                    <iframe data-src="work-stealing.html" width="712px" height="380px" style="margin: auto;"></iframe>
                </section>
                <section  data-background-image="img/backgrounds/lightgrey3.svg">
                    <h3>Embarassingly Parallel Search</h3>
                    <ul>
                        <li>Extension of Static Decomposition</li>
                        <li class="fragment">Numerous subproblems</li>
                        <li class="fragment">Static or dynamic assignation to worker</li>
                        <li class="fragment">More subproblems = better balancing</li>
                    </ul>
                    <iframe data-src="eps13.html" width="540px" height="400px" style="margin: auto;"></iframe>
                </section>
                <section data-background-image="img/backgrounds/orange1.svg">
                    <h2>Decompositions</h2>
                </section>
                <section>
                    <section>
                        <h3>Importance of decompositions</h3>
                        <br/>
                        <br/>
                        <p>
                            Given $t_{\text{max}}$, the solving time of the largest subproblem:
                        </p>
                        <ul>
                            <li>Minimum solving time is then $t_{\text{max}}$</li>
                            <li>The maximum inactivity time of any worker is $t_{\text{max}}$</li>
                        </ul>
                        <br/><br/><br/>
                        <h4>
                            Decompositions should minimize $t_{\text{max}}$.
                        </h4>
                    </section>
                    <section>
                        <h3>Decompositions on COPs</h3>
                        <br/>
                        <br/>
                        <p>For optimization problems</p>
                        <h4>More balanced subproblems = better chances to find the optimum rapidly</h4>
                    </section>
                </section>
                <section>
                    <section>
                        <h3>IDDFS</h3>
                        Iterative deepening DFS, subproblems are the nodes on the last depth visited.<br/>
                        <br/>
                        <ol>
                            <li>For maxDepth=1</li>
                            <li>Do a DFS up to depth maxDepth, keep frontier in memory</li>
                            <li>If frontier not big enough, increase maxDepth, start from 1</li>
                            <li>Return frontier as subproblems</li>
                        </ol>
                    </section>
                    <section>
                        <h3>Good enough?</h3>
                        Implicit assumption: each node at the same height are +/- the same space size
                        <br/>
                        <br/>
                        <h4>In practice? False.</h4>
                        <img data-src="img/golomb_decomp_regin.png"/>
                    </section>
                </section>
                <section>
                    <section>
                        <h3>CPIR</h3>
                        Idea: iterative refinement + decompose bigger subproblems first.<br/>
                        <br/>
                        Bigger = greater Cartesian Product Cardinality<br/>
                        <br/>
                        <ol>
                            <li>Init a priority queue pq</li>
                            <li>Put the initial problem inside</li>
                            <li>While pq.size < threshold
                                <ol>
                                    <li>Get biggest subproblem</li>
                                    <li>Divide it</li>
                                    <li>Put new subproblems in the queue</li>
                                </ol>
                            </li>
                        </ol>
                    </section>
                    <section>
                        <h3>Good enough?</h3>
                        <img data-src="img/golomb_decomp_cpr_binary.png"/>
                    </section>
                </section>
                <section>
                    <h3>CPIR vs IDDFS</h3>
                    <img data-src="img/iddfs_vs_cpir.png"/>
                </section>
                <section data-background-image="img/backgrounds/green2.svg">
                    <h2>Bound management</h2>
                </section>
                <section>
                    <h3>EPS for COPs</h3>
                    <img data-src="img/speedup_comm.svg"/>
                </section>
                <section data-background-image="img/backgrounds/lightred2.svg">
                    <h2>OscaR-Modeling</h2>
                </section>
                <section>
                    <h3>Need for a new layer</h3>
                    <p>Problems with OscaR-CP:</p>
                    <ul>
                        <li>Directly concretized variables</li>
                        <li>Directly concretized constraint (loss of reference)</li>
                        <li>No serialization</li>
                        <li>...</li>
                    </ul>
                </section>
                <section>
                    <section>
                        <h3>Features of OscaR-Modeling</h3>
                        <ul>
                            <li>"Solver-agnostic"</li>
                            <li>Dichotomy model/solver</li>
                            <li>DSL nearly equivalent as OscaR-CP</li>
                            <li>Algebra</li>
                            <li>Presolving capabilities</li>
                            <li>Model Tree / Model Operators</li>
                            <li>Reusable searches</li>
                            <li>Parallel Solving with EPS</li>
                            <li>Distributed Solving with EPS</li>
                        </ul>
                    </section>
                    <section>
                        <h3>Model Tree, Model Operators</h3>
                        <img data-src="img/semantic.png"/>
                    </section>
                    <section>
                        <h3>Algebra simplification</h3>
                        <table >
                            <tr>
                                <td style="text-align: center;">Before simplification</td>
                                <td style="text-align: center;">After simplification</td>
                            </tr>
                            <tr>
                                <td style="text-align: center;">
                                    <img data-src="img/sendmoremoney1.png"/>
                                </td>
                                <td style="text-align: center;">
                                    <img data-src="img/sendmoremoney2.png"/>
                                </td>
                            </tr>
                            <tr>
                                <td style="text-align: center;">23 constraints</td>
                                <td style="text-align: center;">2 constraints</td>
                            </tr>
                        </table>
                    </section>
                </section>
                <section>
                    <h3>OscaR-Modeling is...</h3>
                    <ul>
                        <li>123 Scala files:
                            <ul>
                                <li>3924 code lines</li>
                                <li>1726 comments lines (30.3%)</li>
                                <li>1001 blank lines</li>
                                <li><b>6691</b> total lines</li>
                            </ul>
                        </li>
                        <li>
                            1 Java file (...)
                        </li>
                        <li>
                            32 algebra operators
                        </li>
                    </ul>
                </section>
                <section>
                    <section data-background-image="img/backgrounds/orange2.svg">
                        <h2>OscaR-Modeling with EPS</h2>
                    </section>
                    <section>
                        <h3>Golomb ruler - 13 - EPS vs Work-Stealing</h3>
                        <img src="img/speedup_ws_vs_eps_golomb.svg"/>
                    </section>
                    <section>
                        <h3>16-Queens - EPS vs Work-Stealing</h3>
                        <img src="img/speedup_ws_vs_eps_queens.svg"/>
                    </section>
                    <section>
                        <h3>QAP - 11 - 256 workers</h3>
                        <img src="img/speedup_qap_256.svg"/>
                    </section>
                    <section>
                        <h3>Golomb ruler - 14 - 1024 workers</h3>
                        <img src="img/speedup_golomb_1024.svg"/>
                    </section>
                </section>
                <section data-background-image="img/backgrounds/lightred2.svg">
                    <h2>Conclusion</h2>
                </section>
                <section data-background-image="img/backgrounds/green1.svg">
                    <h2>Everything is a FOSS</h2>
                    <h3>Free, open-source software</h3>
                    <a href="https://github.com/GuillaumeDerval/MasterThesis-Oscar-Model">https://github.com/GuillaumeDerval/MasterThesis-Oscar-Model</a>
                    <h3>Free, open-source slides</h3>
                    <a href="https://github.com/GuillaumeDerval/MasterThesis-Presentation">https://github.com/GuillaumeDerval/MasterThesis-Presentation</a>
                </section>
                <section>
                    <h3>Credits & Acknowledgments</h3>
                    <h4>Content</h4>
                    <p style="font-size: 0.6em;">
                        References: same as master's thesis<br/>
                        <br/>
                        Computational resources have been provided by the Consortium des Équipements de Calcul Intensif (CÉCI), funded by the Fonds de la Recherche Scientifique de Belgique (F.R.S.-FNRS) under Grant No. 2.5020.11
                    </p>
                    <h4>Slides</h4>
                    <ul style="font-size: 0.6em;">
                        <li>Slide made using <a href="https://github.com/hakimel/reveal.js">reveal.js</a></li>
                        <li>Animation made with <a href="https://d3js.org/">D3.js</a></li>
                        <li>Code counts: <a href="https://github.com/blackducksoftware/ohcount">OHCount</a></li>
                        <li>Triangle backgrounds: <a href="https://msurguy.github.io/triangles/">https://msurguy.github.io/triangles/</a></li>
                    </ul>
                    <p style="font-size: 8px;">And sorry for those who don't love triangles :-(</p>
                </section>
			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>
			// More info https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				history: true,
                controls: true,
                transition: "slide",
                backgroundTransition: 'fade',
                math: {
                    mathjax: 'https://cdn.mathjax.org/mathjax/latest/MathJax.js',
                    config: 'TeX-AMS_HTML-full'  // See http://docs.mathjax.org/en/latest/config-files.html
                },
				// More info https://github.com/hakimel/reveal.js#dependencies
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
                    { src: 'plugin/math/math.js', async: true },
                    { src: 'plugin/menu/menu.js' }
				],
                menu: {
                    side: 'left',
                    numbers: true,
                    titleSelector: 'h1, h2, h3, h4, h5, h6',
                    hideMissingTitles: false,
                    markers: true,
                    custom: false,
                    themes: [
                        { name: 'Black', theme: 'css/theme/black.css' },
                        { name: 'White', theme: 'css/theme/white.css' },
                        { name: 'League', theme: 'css/theme/league.css' },
                        { name: 'Sky', theme: 'css/theme/sky.css' },
                        { name: 'Beige', theme: 'css/theme/beige.css' },
                        { name: 'Simple', theme: 'css/theme/simple.css' },
                        { name: 'Serif', theme: 'css/theme/serif.css' },
                        { name: 'Blood', theme: 'css/theme/blood.css' },
                        { name: 'Night', theme: 'css/theme/night.css' },
                        { name: 'Moon', theme: 'css/theme/moon.css' },
                        { name: 'Solarized', theme: 'css/theme/solarized.css' },
                        { name: 'Custom', theme: 'css/theme/custom.css' }
                    ],
                    transitions: true,
                    openButton: true,
                    openSlideNumber: false,
                    keyboard: true
                }
			});

            Reveal.addEventListener( 'fragmentshown', function( event ) {
                var w = $("iframe", Reveal.getCurrentSlide())[0].contentWindow;
                w.postMessage("showFragment","*");
            } );
		</script>
	</body>
</html>
